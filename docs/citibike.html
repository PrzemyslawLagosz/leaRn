<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Przemyslaw Lagosz" />


<title>Explore Citi Bike Data</title>

<script src="site_libs/header-attrs-2.7/header-attrs.js"></script>
<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/yeti.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/kePrint-0.0.1/kePrint.js"></script>
<link href="site_libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>


<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>







<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.tab('show');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-sm-12 col-md-4 col-lg-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-sm-12 col-md-8 col-lg-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Notebook</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">
    <span class="fas fa-home"></span>
     
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Spatial Objects
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="learn_maps.html">Pierwsze mapy - NAUKA</a>
    </li>
    <li>
      <a href="mapa.polski.html">Mapa Polski</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    pogRomcy
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li class="dropdown-header">SEZON 1</li>
    <li>
      <a href="pogRomcy1.2.html">Odczytywanie, zapisywanie i indeksowanie danych</a>
    </li>
    <li>
      <a href="pogRomcy1.3.html">Instrukcje sterujące, pętle, warunki i funkcje</a>
    </li>
    <li>
      <a href="pogRomcy1.4.html">Podstawowe typy danych i ich statystyki opisowe</a>
    </li>
    <li>
      <a href="pogRomcy1.5.html">Przetwarzanie potokowe danych</a>
    </li>
    <li class="divider"></li>
    <li class="dropdown-header">SEZON 2</li>
    <li>
      <a href="pogRomcy2.2.html">Jak zrobić wykres w pakiecie ggplot2?</a>
    </li>
    <li>
      <a href="pogRomcy2.3.html">Modelowanie danych ilościowych</a>
    </li>
    <li>
      <a href="pogRomcy2.4.html">Modelowanie danych jakościowych</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    CodeAcademy
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li class="dropdown-header">Manipulatig Data</li>
    <li>
      <a href="koronawirus.html">Koronawirus - projekt</a>
    </li>
    <li class="divider"></li>
    <li class="dropdown-header">Vizualization</li>
    <li>
      <a href="citibike.html">City Bike</a>
    </li>
    <li>
      <a href="museums.html">Muzea w Ameryce</a>
    </li>
    <li class="divider"></li>
    <li class="dropdown-header">Regresja</li>
    <li>
      <a href="linearproject.html">Linear Regresion</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    SQL
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="https://docs.google.com/presentation/d/1tuMTekNUCk41AXpcw1F0GEjaU2Jb5goExVZaFq9Q8T4/edit?usp=sharing">Usage Funnel with Warby Parker</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="mailto:&lt;przemyslawlagosz1@gmail.com&gt;">
    <span class="fas fa-envelope"></span>
     
  </a>
</li>
<li>
  <a href="https://github.com/PrzemyslawLagosz/leaRn">Git</a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">



<h1 class="title toc-ignore">Explore Citi Bike Data</h1>
<h4 class="author">Przemyslaw Lagosz</h4>
<h4 class="date">24-03-2021</h4>

</div>


<div id="citi-bike-data" class="section level1">
<h1>Citi Bike Data</h1>
<p>Welcome to the off platform project focused on visualization. In this project, we will be exploring data associated with the New York City bike share program, Citi Bike! Remember, it may be easiest to read these instructions by clicking on the “Preview” button in RStudio.</p>
<p>There are over 850 Citi Bike stations in New York City — users check a bike out from a starting station and then dock that bike at a different station when they reach their destination. Citi Bike offers a variety of memberships, but most memberships allow for trips between 30 and 45 minutes — this will be relevant once we start digging into the dataset.</p>
<p>Citi Bike publically releases a variety of datasets. We’ve included a dataset containing information about individual trips from January of 2020. If you’d like to download a more recent dataset, or investigate other data that Citi Bike provides, take a look at their <a href="https://www.citibikenyc.com/system-data">System Data</a> page. There are so many interesting questions that you can investigate with this data — we’re about to walk you through a few, but we’d love to see what else you can discover!</p>
</div>
<div id="investigate-the-data" class="section level1">
<h1>Investigate the Data</h1>
<p>Wczytanie danych.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load the data set into a data frame</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>all_data <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;C:/R/CodeAcademy/Citibike_Project/january_trips_subset.csv&quot;</span>)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(all_data)</span></code></pre></div>
<pre><code>## [1] 100000     16</code></pre>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Wgranie bibliotek</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kableExtra)</span></code></pre></div>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Investigate the data</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(all_data) <span class="sc">%&gt;%</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mine_kable</span>()</span></code></pre></div>
<div style="border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:300px; overflow-x: scroll; width:100%; ">
<table class="table table-striped table-hover table-condensed" style="font-size: 10px; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
X
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
tripduration
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
starttime
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
stoptime
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
start.station.id
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
start.station.name
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
start.station.latitude
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
start.station.longitude
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
end.station.id
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
end.station.name
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
end.station.latitude
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
end.station.longitude
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
bikeid
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
usertype
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
birth.year
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
gender
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1420
</td>
<td style="text-align:left;">
2020-01-12 11:58:32.4220
</td>
<td style="text-align:left;">
2020-01-12 12:22:12.5870
</td>
<td style="text-align:right;">
3256
</td>
<td style="text-align:left;">
Pier 40 - Hudson River Park
</td>
<td style="text-align:right;">
40.72771
</td>
<td style="text-align:right;">
-74.01130
</td>
<td style="text-align:right;">
412
</td>
<td style="text-align:left;">
Forsyth St &amp; Canal St
</td>
<td style="text-align:right;">
40.71582
</td>
<td style="text-align:right;">
-73.99422
</td>
<td style="text-align:right;">
41482
</td>
<td style="text-align:left;">
Customer
</td>
<td style="text-align:right;">
1994
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
539
</td>
<td style="text-align:left;">
2020-01-05 09:37:51.3740
</td>
<td style="text-align:left;">
2020-01-05 09:46:50.7600
</td>
<td style="text-align:right;">
128
</td>
<td style="text-align:left;">
MacDougal St &amp; Prince St
</td>
<td style="text-align:right;">
40.72710
</td>
<td style="text-align:right;">
-74.00297
</td>
<td style="text-align:right;">
168
</td>
<td style="text-align:left;">
W 18 St &amp; 6 Ave
</td>
<td style="text-align:right;">
40.73971
</td>
<td style="text-align:right;">
-73.99456
</td>
<td style="text-align:right;">
19904
</td>
<td style="text-align:left;">
Subscriber
</td>
<td style="text-align:right;">
1965
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
238
</td>
<td style="text-align:left;">
2020-01-25 10:47:55.5770
</td>
<td style="text-align:left;">
2020-01-25 10:51:53.9540
</td>
<td style="text-align:right;">
276
</td>
<td style="text-align:left;">
Duane St &amp; Greenwich St
</td>
<td style="text-align:right;">
40.71749
</td>
<td style="text-align:right;">
-74.01046
</td>
<td style="text-align:right;">
327
</td>
<td style="text-align:left;">
Vesey Pl &amp; River Terrace
</td>
<td style="text-align:right;">
40.71534
</td>
<td style="text-align:right;">
-74.01658
</td>
<td style="text-align:right;">
38561
</td>
<td style="text-align:left;">
Subscriber
</td>
<td style="text-align:right;">
1944
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
189
</td>
<td style="text-align:left;">
2020-01-17 08:03:12.6320
</td>
<td style="text-align:left;">
2020-01-17 08:06:21.8730
</td>
<td style="text-align:right;">
3689
</td>
<td style="text-align:left;">
W 104 St &amp; Amsterdam Ave
</td>
<td style="text-align:right;">
40.79904
</td>
<td style="text-align:right;">
-73.96649
</td>
<td style="text-align:right;">
3328
</td>
<td style="text-align:left;">
W 100 St &amp; Manhattan Ave
</td>
<td style="text-align:right;">
40.79500
</td>
<td style="text-align:right;">
-73.96450
</td>
<td style="text-align:right;">
35170
</td>
<td style="text-align:left;">
Subscriber
</td>
<td style="text-align:right;">
1960
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
741
</td>
<td style="text-align:left;">
2020-01-23 22:42:59.9520
</td>
<td style="text-align:left;">
2020-01-23 22:55:21.5230
</td>
<td style="text-align:right;">
3420
</td>
<td style="text-align:left;">
Douglass St &amp; 3 Ave
</td>
<td style="text-align:right;">
40.68021
</td>
<td style="text-align:right;">
-73.98433
</td>
<td style="text-align:right;">
3558
</td>
<td style="text-align:left;">
Bergen St &amp; Vanderbilt Ave
</td>
<td style="text-align:right;">
40.67944
</td>
<td style="text-align:right;">
-73.96804
</td>
<td style="text-align:right;">
17359
</td>
<td style="text-align:left;">
Subscriber
</td>
<td style="text-align:right;">
1992
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
568
</td>
<td style="text-align:left;">
2020-01-15 20:37:44.8000
</td>
<td style="text-align:left;">
2020-01-15 20:47:13.2320
</td>
<td style="text-align:right;">
252
</td>
<td style="text-align:left;">
MacDougal St &amp; Washington Sq
</td>
<td style="text-align:right;">
40.73226
</td>
<td style="text-align:right;">
-73.99852
</td>
<td style="text-align:right;">
150
</td>
<td style="text-align:left;">
E 2 St &amp; Avenue C
</td>
<td style="text-align:right;">
40.72087
</td>
<td style="text-align:right;">
-73.98086
</td>
<td style="text-align:right;">
29881
</td>
<td style="text-align:left;">
Subscriber
</td>
<td style="text-align:right;">
1996
</td>
<td style="text-align:right;">
1
</td>
</tr>
</tbody>
</table>
</div>
<div id="dodanie-customowych-suffixów-do-wykresu" class="section level2">
<h2>Dodanie customowych suffixóW do wykresu</h2>
<p>Since we have information about the starting and ending location for each trip, let’s quickly make a heat map of the starting locations. Make a heat map using <code>ggplot()</code> and <code>geom_bin2d()</code>. If you make the bin width for each axis very small (we used <code>0.001</code>), you should see the shape of Manhattan, Brooklyn, and Queens! Check out the rectangle in Manhattan with no stations — that’s Central Park!</p>
<p>Make sure to install and load <code>ggplot2</code> and <code>dplyr</code>!</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(all_data)</span></code></pre></div>
<pre><code>##  [1] &quot;X&quot;                       &quot;tripduration&quot;           
##  [3] &quot;starttime&quot;               &quot;stoptime&quot;               
##  [5] &quot;start.station.id&quot;        &quot;start.station.name&quot;     
##  [7] &quot;start.station.latitude&quot;  &quot;start.station.longitude&quot;
##  [9] &quot;end.station.id&quot;          &quot;end.station.name&quot;       
## [11] &quot;end.station.latitude&quot;    &quot;end.station.longitude&quot;  
## [13] &quot;bikeid&quot;                  &quot;usertype&quot;               
## [15] &quot;birth.year&quot;              &quot;gender&quot;</code></pre>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a heatmap</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>add_S <span class="ot">&lt;-</span> <span class="cf">function</span>(x) { </span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  output <span class="ot">&lt;-</span> <span class="fu">paste0</span>(x, <span class="st">&quot;°S&quot;</span>) </span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(output)}</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>add_E <span class="ot">&lt;-</span> <span class="cf">function</span>(y) { </span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>  output <span class="ot">&lt;-</span> <span class="fu">paste0</span>(y, <span class="st">&quot;°E&quot;</span>) </span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(output)}</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>heatmap <span class="ot">&lt;-</span> </span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(all_data, <span class="fu">aes</span>(<span class="at">x =</span> start.station.latitude, <span class="at">y =</span> start.station.longitude)) <span class="sc">+</span></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bin2d</span>(<span class="at">binwidth =</span> <span class="fu">c</span>(<span class="fl">0.008</span>,<span class="fl">0.008</span>)) <span class="sc">+</span></span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Starting point of the rides&quot;</span>, <span class="at">x =</span> <span class="st">&quot;Latitude&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Longitude&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;Number&quot;</span>) <span class="sc">+</span></span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> add_S) <span class="sc">+</span></span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">labels =</span> add_E)</span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a>heatmap</span></code></pre></div>
<p><img src="citibike_files/figure-html/Przygotowanie-1.png" width="672" /></p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Add the age column</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>all_data <span class="ot">&lt;-</span> all_data <span class="sc">%&gt;%</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">age =</span> <span class="dv">2020</span> <span class="sc">-</span> birth.year)</span></code></pre></div>
</div>
</div>
<div id="modifying-the-data-frame-distance" class="section level1">
<h1>Modifying the Data Frame: Distance</h1>
<p>As you write your code that edits the data frame, consider printing the head of the data frame to validate the work you are doing!</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Try creating a distance column in your data frame here:</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="co">#1 lat/long deegre is about 111km</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>distances <span class="ot">&lt;-</span> all_data <span class="sc">%&gt;%</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transmute</span>(<span class="at">gender =</span> gender,</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">age =</span> age,</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">tripduration_h =</span> tripduration<span class="sc">/</span><span class="dv">60</span><span class="sc">/</span><span class="dv">60</span>,</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">long_distance =</span> <span class="fu">abs</span>(start.station.longitude <span class="sc">-</span> end.station.longitude),</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>            <span class="at">lat_distance =</span> <span class="fu">abs</span>(start.station.latitude <span class="sc">-</span> end.station.latitude)) <span class="sc">%&gt;%</span></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">long_km =</span> long_distance<span class="sc">*</span><span class="dv">111</span>,</span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>         <span class="at">lat_km =</span> lat_distance<span class="sc">*</span><span class="dv">111</span>,</span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>         <span class="at">distance_km =</span> <span class="fu">sqrt</span>(long_km<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> lat_km<span class="sc">^</span><span class="dv">2</span>),</span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>         <span class="at">speed_km_per_h=</span> distance_km<span class="sc">/</span>tripduration_h)</span></code></pre></div>
<p>There are many different strategies to calculate the distance between two points. The simplest way to do this would be to find the length of the straight line between the two points. This is a massive assumption to make — it would be remarkable if any of these bike trips traveled in a straight line between the two points without making any turns or curves.</p>
<p>That being said, finding the straight line distance is a good starting point. The <code>distHaversine()</code> function found in the <code>geosphere</code> library can calculate this distance.</p>
<p>First, install and load the <code>geosphere</code> library.</p>
<p>Next, use <code>dplyr</code>’s <code>select()</code> function to create two new data frames that contain only the latitudes and longitudes of the starting and ending points. We called these data frames <code>starting_stations</code> and <code>ending_stations</code>.</p>
<p>Finally, use <code>dplyr</code>’s <code>mutate()</code> function to add a column named <code>distance</code> to your data. <code>distance</code> should be calculated by calling <code>distHaversine()</code> using <code>starting_stations</code> and <code>ending_stations</code> as parameters.</p>
<p>If you get stuck, use <code>?distHaversine</code> to check the documentation to see more examples! You can also use the documentation to find the units of the result of <code>distHaversine()</code>!</p>
</div>
<div id="modifying-the-data-frame-speed" class="section level1">
<h1>Modifying the Data Frame: Speed</h1>
</div>
<div id="modifying-the-data-frame-average-speed-by-age" class="section level1">
<h1>Modifying the Data Frame: Average Speed by Age</h1>
<ul>
<li>Dodanie kolumny <code>speed</code></li>
<li>Odfiltorowanie skrajnych wieków</li>
</ul>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Use group_by() and summarize() to get the mean speed of each age</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>average_speed_by_age <span class="ot">&lt;-</span> distances <span class="sc">%&gt;%</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(age) <span class="sc">%&gt;%</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="at">mean_speed =</span> <span class="fu">mean</span>(speed_km_per_h)) <span class="sc">%&gt;%</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(age <span class="sc">&lt;</span> <span class="dv">80</span> <span class="sc">&amp;</span> age <span class="sc">&gt;</span> <span class="dv">16</span>)</span></code></pre></div>
</div>
<div id="visualization" class="section level1">
<h1>Visualization!</h1>
<p>We made it! We now have the average speed of every age in our dataset. Let’s use <code>ggplot2</code> to make a line graph to see if younger people really do bike faster. Make sure to install and load <code>ggplot2</code> if you haven’t done so already. Pass your data frame to <code>ggplot()</code> and add a <code>geom_line()</code>. <code>geom_line()</code> should contain an aesthetic where <code>x = age</code> and <code>y = mean_speed</code>.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Install and load ggplot2 to create a line graph of age and mean speed</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>speed_age <span class="ot">&lt;-</span> </span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(average_speed_by_age, <span class="fu">aes</span>(<span class="at">x =</span> age, <span class="at">y =</span> mean_speed)) <span class="sc">+</span> </span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">colour =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span> </span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">alpha =</span> <span class="fl">0.05</span>) <span class="sc">+</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Age vs Average spped graph&quot;</span>, <span class="at">subtitle =</span> <span class="st">&quot;In group 18-80 yrs old&quot;</span>, <span class="at">x =</span> <span class="st">&quot;Age [years]&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Mean speed [km/h]&quot;</span>)</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>speed_age</span></code></pre></div>
<p><img src="citibike_files/figure-html/Wykres%20speed_age-1.png" width="672" /></p>
</div>
<div id="filtering-by-gender" class="section level1">
<h1>Filtering By Gender</h1>
<ul>
<li>Pogrupowanie na płcie.</li>
</ul>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Use group_by() again to group by both age and gender</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>average_speed_by_age_and_gender <span class="ot">&lt;-</span> distances <span class="sc">%&gt;%</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(age, gender) <span class="sc">%&gt;%</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="at">mean_speed =</span> <span class="fu">mean</span>(speed_km_per_h)) <span class="sc">%&gt;%</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(age <span class="sc">&lt;</span> <span class="dv">80</span> <span class="sc">&amp;</span> age <span class="sc">&gt;</span> <span class="dv">16</span>)</span></code></pre></div>
<p>Let’s now visualize the difference in average speed by age <em>and</em> gender. Note that if you look in the documentation for the data, a <code>0</code> represents a user that didn’t specify their gender as male or female, a <code>1</code> represents a user identifying as male, and a <code>2</code> represents a user identifying as female.</p>
<p>The previous call to <code>ggplot()</code> and <code>geom_line()</code> should be close to what we want. Add the parameter <code>color = gender</code> to the aesthetic in <code>geom_line()</code>. Make sure you use the new data containing the gender information! You once again may want to filter out the ages greater than 80.</p>
<p>Note that this graph won’t quite be what we want yet, but we’re getting close!</p>
<div id="wykres-wygląda-jak-wygląda-poniewaz-zmienna-gender-jest-ciągła.-nie-jest-faktorem." class="section level3">
<h3>Wykres wygląda jak wygląda poniewaz zmienna <code>gender</code> jest ciągła. Nie jest faktorem.</h3>
<p><strong>EDIT: 26.03.2021</strong> - Przy knitowaniu wykreś nie chiał przyjąć gender jako wartości ciągłej, wiec zmiana na faktor</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Make a line graph of your new filtered data frame</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>speed_age_and_gender <span class="ot">&lt;-</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(average_speed_by_age_and_gender, <span class="fu">aes</span>(<span class="at">x =</span> age, <span class="at">y =</span> mean_speed)) <span class="sc">+</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">colour =</span> <span class="fu">factor</span>(gender))) <span class="sc">+</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Age and Gender vs Average spped graph&quot;</span>,</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">&quot;In group 18-80 yrs old&quot;</span>,</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;Age [years]&quot;</span>,</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;Mean speed [km/h]&quot;</span>,</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">colour =</span> <span class="st">&quot;Gender&quot;</span>) <span class="sc">+</span></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_colour_discrete</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;1&quot;</span> <span class="ot">=</span> <span class="st">&quot;Male&quot;</span>, <span class="st">&quot;2&quot;</span> <span class="ot">=</span> <span class="st">&quot;Female&quot;</span>))</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>speed_age_and_gender</span></code></pre></div>
<p><img src="citibike_files/figure-html/Wykres%20wiek_plec-1.png" width="672" /></p>
<ul>
<li>Zmiana zmiennej <code>gender</code> na faktor.</li>
</ul>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Use mutate() and as.factor() to change the gender column into a factor.</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>average_speed_by_age_and_gender <span class="ot">&lt;-</span> average_speed_by_age_and_gender <span class="sc">%&gt;%</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">gender =</span> <span class="fu">as.factor</span>(gender)) <span class="sc">%&gt;%</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(gender <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span></code></pre></div>
<ul>
<li>Finalny graph.</li>
</ul>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter the data frame to only include genders 1 and 2. Set appropriate labels for the legend</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>speed_age_and_gender <span class="ot">&lt;-</span> </span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(average_speed_by_age_and_gender, <span class="fu">aes</span>(<span class="at">x =</span> age, <span class="at">y =</span> mean_speed)) <span class="sc">+</span> </span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">colour =</span> gender)) <span class="sc">+</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>  <span class="co">#geom_smooth() +</span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Age and Gender vs Average spped graph&quot;</span>, <span class="at">subtitle =</span> <span class="st">&quot;In group 18-80 yrs old&quot;</span>, <span class="at">x =</span> <span class="st">&quot;Age [years]&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Mean speed [km/h]&quot;</span>, <span class="at">colour =</span> <span class="st">&quot;Gender&quot;</span>)<span class="sc">+</span></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_colour_discrete</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;1&quot;</span> <span class="ot">=</span> <span class="st">&quot;Male&quot;</span>, <span class="st">&quot;2&quot;</span> <span class="ot">=</span> <span class="st">&quot;Female&quot;</span>))</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>speed_age_and_gender</span></code></pre></div>
<p><img src="citibike_files/figure-html/Wykres%20age_gender-1.png" width="672" /></p>
</div>
</div>
<div id="making-a-stacked-bar-plot-of-ages" class="section level1">
<h1>Making a Stacked Bar Plot Of Ages</h1>
<ul>
<li>Ilosć męskich i zenskich użytkowników</li>
</ul>
<p>Let’s start by using our <code>short_trips</code> dataset. We’ll want to call <code>group_by()</code> using this dataset and pipe the result to <code>tally()</code>. This will let us get a count of the number of bikers for each age and gender.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the age_counts data frame</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>age_counts <span class="ot">&lt;-</span> distances <span class="sc">%&gt;%</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(age, gender) <span class="sc">%&gt;%</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Sytnax zliczający ile wystepuje w danej grupie</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tally</span>() <span class="sc">%&gt;%</span></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Odfiltrowanie skarjnosci</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(age <span class="sc">&gt;</span> <span class="dv">16</span> <span class="sc">&amp;</span> age <span class="sc">&lt;</span> <span class="dv">80</span>) <span class="sc">%&gt;%</span></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">gender =</span> <span class="fu">as.factor</span>(gender)) <span class="sc">%&gt;%</span></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(gender <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(age_counts) <span class="sc">%&gt;%</span></span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mine_kable</span>()</span></code></pre></div>
<div style="border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:300px; overflow-x: scroll; width:100%; ">
<table class="table table-striped table-hover table-condensed" style="font-size: 10px; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
age
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
gender
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
n
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
17
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:right;">
64
</td>
</tr>
<tr>
<td style="text-align:right;">
17
</td>
<td style="text-align:left;">
2
</td>
<td style="text-align:right;">
13
</td>
</tr>
<tr>
<td style="text-align:right;">
18
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:right;">
131
</td>
</tr>
<tr>
<td style="text-align:right;">
18
</td>
<td style="text-align:left;">
2
</td>
<td style="text-align:right;">
21
</td>
</tr>
<tr>
<td style="text-align:right;">
19
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:right;">
237
</td>
</tr>
<tr>
<td style="text-align:right;">
19
</td>
<td style="text-align:left;">
2
</td>
<td style="text-align:right;">
48
</td>
</tr>
</tbody>
</table>
</div>
<p>If you look at the head of this new data frame, you’ll see the counts are stored in a column named <code>n</code>. Let’s now use <code>ggplot()</code> and <code>geom_col()</code> to create a stacked bar plot. <code>ggplot()</code> should have an <code>aes()</code> where <code>x = age</code>, <code>y = n</code> and <code>fill = gender</code>.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the stacked bar plot</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>users_by_gender <span class="ot">&lt;-</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(age_counts, <span class="fu">aes</span>(<span class="at">x =</span> age, <span class="at">y =</span> n, <span class="at">fill =</span> gender)) <span class="sc">+</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>() <span class="sc">+</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Number of users&quot;</span>, <span class="at">subtitle =</span> <span class="st">&quot;By age and gender&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Number&quot;</span>, <span class="at">x =</span> <span class="st">&quot;Age&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;Gender&quot;</span>) <span class="sc">+</span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_discrete</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&#39;1&#39;</span> <span class="ot">=</span> <span class="st">&#39;Men&#39;</span>, <span class="st">&#39;2&#39;</span> <span class="ot">=</span> <span class="st">&#39;Women&#39;</span>))</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>users_by_gender</span></code></pre></div>
<p><img src="citibike_files/figure-html/Uzytkownicy%20by%20gender-1.png" width="672" /></p>
<p>Finally, we labeled and titled our graph using <code>labs()</code> and <code>scale_fill_discrete()</code></p>
<div id="further-work" class="section level3">
<h3>Further Work</h3>
<p>Great work! You’ve made several graphs that show a real difference in the way different groups of Citi Bike users bike. This could be a valuable asset in helping Citi Bike understand how to make bike riding safer in New York. However, there is so much more you can do with this data!</p>
<p>To begin, there are some major flaws in the way we calculated the speed. Specifically, we made some <em>huge</em> assumptions when calculating the distance of each bike ride. Instead of calculating the straight line distance using the geosphere library, we could take advantage of a service like Google Map’s API to get a more accurate measurement of distance. If you’re interested in look more into this problem, investigate getting a <a href="https://developers.google.com/maps/documentation/geocoding/get-api-key">Google Maps API key</a> and using a library like <a href="https://cran.r-project.org/web/packages/gmapsdistance/gmapsdistance.pdf">gmapsdistance</a>.</p>
<p>Another great way to extend this project is to investigate other data that Citi Bike makes available. We used data found in the <em>Citi Bike Trip Histories</em> section on the <a href="https://www.citibikenyc.com/system-data">System Data</a> page. On the System Data page, you can find different dataset, including information about membership data and real time station data. You could use this real time data to track how the flow of bikes changes over the course of the day. You could investigate how the weather impacts membership. We would love to see any graphs or insights you produce!</p>
</div>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
